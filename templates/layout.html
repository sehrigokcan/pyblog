{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css'%}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <!-- Font awesome kullanmak icin css dosyasi ekliyoruz -->
    <style>   
    .btn-dislike, .btn-like {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        border-radius: 50%;
        line-height: 1;
        height: 3rem;
        width: 3rem;
        margin-left: 1rem;
    }

    .fa {
        font-size: 1.6em;
    }

    </style>
    <title>Blog</title>
</head>
<body>
    {% include 'includes/navbar.html' %}
    <div style='margin-top:100px; margin-bottom:100px', class = 'container'>
        <!--'margin-top:100px; üsten boşluk , margin-bottom:100px' alttan boşluk bırakmak için -->
        {% if messages %}
            {% for message in messages %}
                {% if message.tags == 'info' %} 
                    <div class = 'alert alert-danger'>{{message}}</div>
                    <!--Eğer mesaj info tag ile gelirse dangerı kullan-->
                {% else %}
                    <div class = 'alert alert-{{message.tags}}'>{{message}}</div>
                    <!--Diğer durumda successı kullan--> 
                {% endif %}
            {% endfor %}
        {% endif %}
        {% block body %}

        {% endblock body %}

    </div>

        
        <script src="{% static 'js/jquery-3.4.1.min.js' %}"></script>
        <script src="{% static 'js/bootstrap.min.js' %}"></script>
        <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
        <script type="text/javascript">

            function likeOrDislikePost(event) {
                <!-- Sayfada idsi like olan buton icin click olayini dinleyen bir fonksiyon calistiriliyor. -->
                $(document).on('click', '#like', function (event) {
                    <!-- Sayfanin yenilenmemesi icin olayin (click event) varsayilan davranislarini devre disi birakiyoruz  -->
                    event.preventDefault();

                    <!-- Butonlarin value attribute una artikel in id degerini vermistik. Bunu pk degiskenine atiyoruz. -->
                    var pk = $(this).attr('value');

                    $.ajax({
                        type: 'POST',
                        url: '{% url "article:like_article" %}',
                        data: {'id': pk, "csrfmiddlewaretoken": '{{ csrf_token}}'},
                        dataType: 'json',
                        success: function (response) {
                            <!-- Ajax request basarili olursa id verisini data objesi ile ilgili fonksiyona iletiyoruz. -->
                            <!-- like-section html blogunu guncellenmis veri ile tekrar degistiriyoruz -->
                            $('#like-section').html(response['form'])
                        },
                        error: function (rs, e) {
                            <!-- Ajax request sirasinda hata olursa tarayicinin konsolundan hatayi gorebiliriz. -->
                            console.log(rs.responseText);
                        }
                    });
                });

            }

            <!-- Html dosyasi hazir oldugunda likeOrDislikePost fonksiyonu aktif olacaktir -->
            $(document).ready(likeOrDislikePost);
</script>
    
    
    </body>
</html>

